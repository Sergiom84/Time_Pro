{% extends 'base.html' %}

{% block title %}Gestionar Centros - TimeTracker{% endblock %}

{% block header %}<span class="text-timetracker-primary">Gestionar Centros</span>{% endblock %}

{% block content %}
<section class="bg-gray-800 shadow-md rounded-lg p-6 mb-6">
  <div class="mb-5">
      <a href="{{ url_for('admin.add_center') }}"
         class="inline-block py-2 px-4 rounded-lg text-white transition-all duration-300 ease-in-out shadow-md hover:opacity-90"
         style="background-color: var(--accent-primary);">
          Agregar Nuevo Centro
      </a>
  </div>

  <p class="text-gray-400 text-sm mb-4">
    Aquí puedes gestionar los centros/sucursales disponibles para tu cliente.
    Cada cliente puede tener sus propios centros personalizados.
  </p>
</section>

<section class="bg-gray-900 shadow-md rounded-lg p-6 overflow-hidden">
  <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-700 text-sm">
          <thead class="bg-gray-800 text-gray-400 text-xs uppercase">
              <tr>
                  <th class="px-4 py-2 text-left">Nombre</th>
                  <th class="px-4 py-2 text-left">Estado</th>
                  <th class="px-4 py-2 text-left">Usuarios</th>
                  <th class="px-4 py-2 text-left">Acciones</th>
              </tr>
          </thead>
          <tbody class="divide-y divide-gray-700">
              {% for center in centers %}
              <tr>
                  <td class="px-3 py-2 whitespace-nowrap text-gray-100">
                      <span class="font-semibold">{{ center.name }}</span>
                  </td>
                  <td class="px-3 py-2 whitespace-nowrap text-gray-100">
                      <span class="{% if center.is_active %}bg-green-900 text-green-300{% else %}bg-red-900 text-red-300{% endif %} px-2 py-1 rounded text-xs font-medium">
                          {{ 'Activo' if center.is_active else 'Inactivo' }}
                      </span>
                  </td>
                  <td class="px-3 py-2 whitespace-nowrap text-center text-gray-100">
                      {{ center.users|length }}
                  </td>
                  <td class="px-3 py-2 whitespace-nowrap">
                      <div class="flex items-center gap-2">
                          <a href="{{ url_for('admin.edit_center', center_id=center.id) }}"
                             class="inline-block py-1 px-2.5 rounded bg-timetracker-secondary text-white hover:opacity-90 transition-opacity duration-300 ease-in-out text-xs">
                              Editar
                          </a>
                          <form action="{{ url_for('admin.delete_center', center_id=center.id) }}"
                                method="POST"
                                class="inline"
                                onsubmit="return confirm('¿Estás seguro de que deseas eliminar este centro?');">
                              <button type="submit"
                                      class="py-1 px-2.5 rounded bg-red-800 hover:bg-red-700 text-white transition-colors duration-300 ease-in-out text-xs"
                                      {% if center.users|length > 0 %}disabled title="No puedes eliminar un centro con usuarios"{% endif %}>
                                  Eliminar
                              </button>
                          </form>
                      </div>
                  </td>
              </tr>
              {% else %}
              <tr>
                  <td colspan="4" class="px-4 py-3 text-center text-gray-500">
                      No hay centros registrados. <a href="{{ url_for('admin.add_center') }}" class="text-timetracker-primary hover:underline">Agregar uno</a>
                  </td>
              </tr>
              {% endfor %}
          </tbody>
      </table>
  </div>
</section>
{% endblock %}
